---
title: "DSjobtracker: What are the qualifications and skills that a data scientist, statistician, or data analyst must possess?"
output: 
  flexdashboard::flex_dashboard:
    orientation: column
    vertical_layout: fill
---
<style>
.tab-content{
position:relative;
top:50px;
}
</style>
```{r setup, include=FALSE}
library(flexdashboard)
library(wordcloud)
library(wordcloud2)
library(tm)
library(RColorBrewer)
library(stringr)
library(tidyverse)
library(plotly)
library(data.table)
library(countrycode)
library(quantmod)
library(formattable)
library(ggwordcloud)
library(dplyr)
library(ggplot2) 
library(readr)
library(readxl)
library(sp)
library(gganimate)
library(ggpubr)
DStidy_2022 <- read_csv("DStidy_2022.csv")
```

Overview
======================================================
Column
-----------------------------------------------------------------------

### Job Title

```{r}

set.seed(1)

##### ----- Job Title data ----- #####

# cleaning

overview_jobtitle <- DStidy_2022 %>% select(Job_title)

overview_jobtitle <- as.vector(overview_jobtitle)

overview_jobtitle_doc <- Corpus(VectorSource(overview_jobtitle))
overview_jobtitle_doc <- overview_jobtitle_doc %>% 
  tm_map(removeNumbers) %>% 
  tm_map(removePunctuation) %>% 
  tm_map(stripWhitespace)
overview_jobtitle_doc <- tm_map(overview_jobtitle_doc, 
                                content_transformer(tolower))
overview_jobtitle_doc <- tm_map(overview_jobtitle_doc, 
                                removeWords, 
                                stopwords("english"))

overview_jobtitle_dtm <- TermDocumentMatrix(overview_jobtitle_doc)

overview_jobtitle_matrix <- as.matrix(overview_jobtitle_dtm)

overview_jobtitle_words <- sort(rowSums(overview_jobtitle_matrix), decreasing=TRUE)

overview_jobtitle_df <- data.frame(words=names(overview_jobtitle_words),
                                   freq=overview_jobtitle_words)

overview_jobtitle_df$words[overview_jobtitle_df$words=="adance"] <- "advance"
overview_jobtitle_df$words[overview_jobtitle_df$words=="birpython"] <- "biopython"
overview_jobtitle_df$words[overview_jobtitle_df$words=="dara"] <- "data"
overview_jobtitle_df$words[overview_jobtitle_df$words=="experiencehia"] <- "experience"
overview_jobtitle_df$words[overview_jobtitle_df$words=="dara"] <- "data"
overview_jobtitle_df$words[overview_jobtitle_df$words=="experiencehia"] <- "experience"
overview_jobtitle_df$words[overview_jobtitle_df$words=="intellegent"] <- "intelligent"
overview_jobtitle_df$words[overview_jobtitle_df$words=="per"] <- "permanenet"
overview_jobtitle_df$words[overview_jobtitle_df$words=="scienctist"] <- "scientist"
overview_jobtitle_df$words[overview_jobtitle_df$words=="scientists"] <- "scientist"

overview_jobtitle_df <- overview_jobtitle_df[!(row.names(overview_jobtitle_df) 
                                             %in% c("-", "csenior", "early", 
                                                    "fair", "sassqltableaupower")), ]

# visualization

ggplot(overview_jobtitle_df, aes(label=words, 
                                 size=freq, 
                                 color=factor(sample.int(10, 
                                                         nrow(overview_jobtitle_df), 
                                              replace = TRUE)))) + 
  ggtitle("") +
  geom_text_wordcloud_area() + 
  scale_size_area(max_size = 45) + 
  theme_bw() + 
  theme(axis.line = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.background = element_blank())

```

### Job Field

```{r}

set.seed(1)

##### ----- Job Field data ----- #####

# cleaning

overview_jobfield <- DStidy_2022 %>% select(Job_Field)

overview_jobfield <- as.vector(overview_jobfield)

overview_jobfield_doc <- Corpus(VectorSource(overview_jobfield))
overview_jobfield_doc <- overview_jobfield_doc %>% 
  tm_map(removeNumbers) %>% 
  tm_map(removePunctuation) %>% 
  tm_map(stripWhitespace)
overview_jobfield_doc <- tm_map(overview_jobfield_doc, 
                                content_transformer(tolower))
overview_jobfield_doc <- tm_map(overview_jobfield_doc, 
                                removeWords, 
                                stopwords("english"))

overview_jobfield_dtm <- TermDocumentMatrix(overview_jobfield_doc)

overview_jobfield_matrix <- as.matrix(overview_jobfield_dtm)

overview_jobfield_words <- sort(rowSums(overview_jobfield_matrix), decreasing=TRUE)

overview_jobfield_df <- data.frame(words=names(overview_jobfield_words),
                                   freq=overview_jobfield_words)

overview_jobfield_df$words[overview_jobfield_df$words=="developmwnt"] <- "development"
overview_jobfield_df$words[overview_jobfield_df$words=="cdata"] <- "data"
overview_jobfield_df$words[overview_jobfield_df$words=="eqipment"] <- "equipment"

# visualization

ggplot(overview_jobfield_df, aes(label=words, 
                                 size=freq, 
                                 color=factor(sample.int(10, 
                                                         nrow(overview_jobfield_df), 
                                                         replace = TRUE)))) + 
  ggtitle("") +
  geom_text_wordcloud_area() + 
  scale_size_area(max_size = 30) + 
  theme_bw() + 
  theme(axis.line = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.background = element_blank())

```


Column
-----------------------------------------------------------------------

### Education Qualification

```{r}

set.seed(1)

##### ----- Education Qualifications ----- #####

# cleaning

eduquali_data <- DStidy_2022 %>% 
  select(Educational_qualifications)

eduquali_data <- as.vector(eduquali_data)

eduquali_data_doc <- Corpus(VectorSource(eduquali_data))

eduquali_data_doc <- eduquali_data_doc %>%
  tm_map(removeNumbers) %>%
  tm_map(removePunctuation) %>%
  tm_map(stripWhitespace)

eduquali_data_doc <- tm_map(eduquali_data_doc, 
                            content_transformer(tolower))

eduquali_data_doc <- tm_map(eduquali_data_doc, 
                            removeWords, 
                            stopwords("english"))

eduquali_data_dtm <- TermDocumentMatrix(eduquali_data_doc)

eduquali_data_matrix <- as.matrix(eduquali_data_dtm)

eduquali_data_words <- sort(rowSums(eduquali_data_matrix), decreasing=TRUE)

eduquali_data_df <- data.frame(words = names(eduquali_data_words),
                               freq = eduquali_data_words)

# selecting the words that show frequency greater than or equal 5
eduquali_data_df_selected <- eduquali_data_df %>%
  filter(freq >= 5)

# correcting the spelling and dropping irrelevant words
eduquali_data_df_selected$words[eduquali_data_df_selected$words=="nanana"] <- NA
eduquali_data_df_selected$words[eduquali_data_df_selected$words=="field"] <- NA
eduquali_data_df_selected$words[eduquali_data_df_selected$words=="related"] <- NA

# omitting the rows with NA
eduquali_data_df_used <- na.omit(eduquali_data_df_selected)

# visualization

ggplot(eduquali_data_df_used, aes(label=words, 
                                  size=freq, 
                                  color=factor(sample.int(10, 
                                                         nrow(eduquali_data_df_used), 
                                                         replace = TRUE)))) + 
  ggtitle("") +
  geom_text_wordcloud_area() + 
  scale_size_area(max_size = 30) + 
  theme_bw() + 
  theme(axis.line = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.background = element_blank())

```

### Company Location

```{r}

set.seed(1)

##### ----- Country data ----- #####

# cleaning

overview_country <- DStidy_2022 %>% select(Country)

overview_country <- as.vector(overview_country)

overview_country_doc <- Corpus(VectorSource(overview_country))
overview_country_doc <- overview_country_doc %>% 
  tm_map(removeNumbers) %>% 
  tm_map(removePunctuation) %>% 
  tm_map(stripWhitespace)
overview_country_doc <- tm_map(overview_country_doc, 
                               content_transformer(tolower))
overview_country_doc <- tm_map(overview_country_doc, 
                               removeWords, 
                               stopwords("english"))

overview_country_dtm <- TermDocumentMatrix(overview_country_doc)

overview_country_matrix <- as.matrix(overview_country_dtm)

overview_country_words <- sort(rowSums(overview_country_matrix), decreasing=TRUE)

overview_country_df <- data.frame(words=names(overview_country_words),
                                  freq=overview_country_words)

overview_country_df$words[overview_country_df$words=="lanka"] <- "srilanka"
overview_country_df$words[overview_country_df$words=="states"] <- "unitedstates"
overview_country_df$words[overview_country_df$words=="kingdom"] <- "unitedkingdom"
overview_country_df$words[overview_country_df$words=="arab"] <- "unitedarabemirates"
overview_country_df$words[overview_country_df$words=="arab"] <- "unitedarabemirates"
overview_country_df$words[overview_country_df$words=="new"] <- "newzealand"

overview_country_df <- overview_country_df[!(row.names(overview_country_df) 
                                             %in% c("united", "sri", "emirates", 
                                                    "csri", "czech")), ]

# visualization

ggplot(overview_country_df, aes(label=words, 
                                size=freq, 
                                color=factor(sample.int(10, 
                                                          nrow(overview_country_df), 
                                                          replace = TRUE)))) + 
  ggtitle("") +
  geom_text_wordcloud_area() + 
  scale_size_area(max_size = 20) + 
  theme_bw() + 
  theme(axis.line = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.background = element_blank())

```


Spatial Distributions
======================================================

Row 
-------------------------------------

### Spatial Distribution of proportion of Job Advertisments
    

### Advertisment Distribution by country



Row {.tabset .tabset-fade}
-------------------------------------
   
### Spatial Distribution by Job Type

 
### Spatial Distribution of Salary

*The minimum annual salary of each country in USD
    



Job Fields
======================================================

Column
--------------------------------------------------------------

### Composition of Job Fields



Column {.tabset .tabset-fade}
--------------------------------------------------------------

### R and Python Requirements of Job Fields


### Tableau and Microsoft Power BI Requirements of Job Fields


### Minimum experience needed in Job Fields


English Requirement
======================================================

## Column {data-width=500}
--------------------------------------------------------------

### English Requirement by Country



## Column {data-width=500, .tabset}
--------------------------------------------------------------

### English Requirement by Job Field


### English Requirement by Job Category




Soft Skills
======================================================

Column {data-width=350}
-----------------------------------------------------------------------

### Composition of demanded Soft Skills


Column {data-width=650}
-----------------------------------------------------------------------

### Demanded Soft Skills according to the Job Field





Experience
======================================================

```{r}
## Packages
library(tidyverse)
library(plotly)
library(DSjobtracker)
```


```{r}
## Install the data set
DStidy_2022 <- read_csv("DStidy_2022.csv")
DStidy_2022 <- DStidy_2022 %>% mutate(`Minimum Experience in Years` = case_when(
 `Minimum Experience in Years` %in% c(0.5,1) ~ 1,
 `Minimum Experience in Years`== 0 ~ 0 ,
  `Minimum Experience in Years`== 2 ~ 2,
  `Minimum Experience in Years`== 3 ~ 3,
  `Minimum Experience in Years`== 4 ~ 4,
  `Minimum Experience in Years`== 5 ~ 5,
  `Minimum Experience in Years`== 6 ~ 6,
  `Minimum Experience in Years`== 7 ~ 7,
  `Minimum Experience in Years`== 8 ~ 8,
  `Minimum Experience in Years`== 10 ~ 10,
  `Minimum Experience in Years`== 12 ~ 12
))
  

```

column{}
----------------------------------------------------------------------

### Distribution of Minimun Years of Experience

```{r}
plot_ly(DStidy_2022,
        x = ~`Minimum Experience in Years`,
        type = "histogram") %>%
  layout(xaxis = list(title = "Minimum Required Experience in Years"),
         yaxis = list(title = "No of Job Advertisements"), 
         showlegend = FALSE)
```


column{.tabset}
-----------------------------------------------------------------------

### Distribution of Experience by Job Category

```{r}
DStidy_2022 <- DStidy_2022 %>% mutate(`Job_Category` = case_when(
   `Job_Category` %in% c("Business Analytics","Business/Systems Analysts","Finance and Sales","Business Development and Sales","Administrative","Human Resources Services", "Consulting, Information Technology, and Sales","Information Services","IT Services") ~ "Buisness Analyst",
  
   `Job_Category` %in% c("Data Science","Database Systems","Statistics","Data science","Research, Consulting, and Analyst","Actuarial Science","Information Technology, Analyst,and Science","Machine Learning","AI", "Artificial Intelligence") ~ "Data Scientist",
 
    `Job_Category` %in% c("Data Analyst","Science & Technology","Sciences","Internet Publishing" ,"Science and Analyst","Analyst","Research, Consulting, and Analyst","Research, Analyst, and Information Technology") ~ "Data Analyst",
 
    `Job_Category` %in% c( "Engineering - Software","Engineering, Mechanical" ,"Data Engineering","Software Developmwnt","Information Technology", "Computer/Information Technology","IT","Analyst, Engineering and Information Technology","Management, Engineering and Analyst","Engineering and Information  Technology","Information Technology and Analyst")~"Data Engineering"
 

))
data_exp <- DStidy_2022 %>% filter(Job_Category != "NA")

plot_ly(data_exp,
        x = ~Job_Category,
        y = ~`Minimum Experience in Years`,
        type = "box",
        color = ~Job_Category,
        colors = c("#1b9e77", "#d95f02", "#7570b3", "#e7298a","blue")) %>%
  layout(xaxis = list(title  = "Job Category", tickangle = 0),
         yaxis = list(title = "Minimum Required Experience in Years"), showlegend = FALSE)
```

### Distribution of Experience by Educational Qualifications


```{r}

edu <- DStidy_2022 %>% select("BSc_needed","MSc_needed","PhD_needed","Minimum Experience in Years")

# convert data set into numeric
edu1 <- as.data.frame(apply(edu, 2, as.numeric))

education <- replace(edu1, is.na(edu1), 1)


data_new <- pivot_longer(education, c(1:3), names_to = "Education", values_to = "Value")



data2 <- data_new %>% filter(Value == 1)


plot_ly(data2,
        x = ~ Education,
        y = ~`Minimum Experience in Years`,
        type = "box",
        color = ~Education,
        colors = c("#e41a1c", "#377eb8", "#4daf4a")) %>%
  layout(xaxis = list(title  = "Minimum Educational Qualifications", tickangle = 0),
         yaxis = list(title = "Minimum Required Experience in Years"), showlegend = FALSE)

```





Software and Skills
======================================================

Column {data-width=500}
-----------------------------------------------------------------------

### Top 20 skills required in jobs

```{r}

Top_skills_required<- DStidy_2022%>%
  select(c(AI:Web_Analytic_tools)) %>%
  pivot_longer(c(AI:Web_Analytic_tools), values_to = "Value", names_to = "Name") %>%
  group_by(Name) %>%
  summarize(Total = sum(Value, na.rm = TRUE)) %>% 
  arrange(Total) 
  
  Top_skills_required %>%
  mutate(Name = factor(Name, levels = .$Name)) %>%
  top_n(20) %>%
plot_ly(
        x= ~Total,
        y= ~reorder(Name,Total),
        type = "bar",
   marker = list(color = "hsl(0,100%,50%))") ,height = 600,width = 700)  %>% 
 
layout(title = "Top 20 Skills Required in Jobs",xaxis = list(title = "No of Job Advertisments"),
         yaxis =list(title = "Skills Required"))
```



Column {data-width=500}
-----------------------------------------------------------------------

### Soft skills required in jobs

```{r}

 Soft_skills_required<- DStidy_2022%>%
  select(c(Presentation_Skills:`agile execution`)) %>%
  pivot_longer(c(Presentation_Skills:`agile execution`), values_to = "Value", names_to = "Name") %>%
  group_by(Name) %>%
  summarize(Total = sum(Value, na.rm = TRUE)) %>% 
  arrange(Total) 

Soft_skills_required %>%
  plot_ly(labels = ~Name,
          values = ~Total,
          parents = NA,
          type = "treemap", height = 600, width = 650, textinfo = "label+value+percent parent") %>%
  layout(title = "Soft Skills Required in Jobs")

```


Software Skills
======================================================

Column {data-width=500}
-----------------------------------------------------------------------

### Statistical softwares

```{r}

Statistical_software <- paste(DStidy_2022$R,DStidy_2022$SAS,DStidy_2022$SPSS,DStidy_2022$Python,sep = "::")


d1 <- Statistical_software %>% table() %>% as.data.frame()
names(d1) <- c('Statistical_software', 'Frequency')
d1 <- d1[order(d1$Frequency, decreasing = T),]

Statistical_software[Statistical_software=="1::0::0::0"] <-"R only"
Statistical_software[Statistical_software=="0::0::0::1"] <-"Python only"
Statistical_software[Statistical_software=="0::1::0::0"] <-"SAS only"
Statistical_software[Statistical_software=="1::0::0::1"] <-"R & Python"
Statistical_software[Statistical_software=="1::1::0::1"] <-"R, SAS & Python only "
Statistical_software[Statistical_software=="0::0::0::0"] <-"No statistical softwares"
Statistical_software[Statistical_software=="0::1::0::1"|
                     Statistical_software=="1::1::1::1"|
                     Statistical_software=="0::1::1::1"|
                     Statistical_software=="1::1::1::0"|
                     Statistical_software=="0::0::1::0"|
                     Statistical_software=="1::0::1::0"|
                     Statistical_software=="1::0::1::1"|
                     Statistical_software=="0::1::1::0"|
                     Statistical_software=="0::1::0::NA"|
                     Statistical_software=="0::0::1::1"|
                     Statistical_software=="1::1::0::0"] <- "Other statistical softwares"


d1 <- Statistical_software %>% table() %>% as.data.frame()
names(d1) <- c('Statistical_software', 'Frequency')
d1 <- d1[order(d1$Frequency, decreasing = T),]


d1 %>% plot_ly(x = ~Frequency, y = ~reorder(Statistical_software, Frequency), 
               type =  'bar', orientation = 'h') %>% 
  layout(title = "", 
         xaxis = list(title = "Number of job advertisements" ,zeroline = FALSE),
         yaxis = list(title = "", zeroline = FALSE))

```



Column {data-width=500}
-----------------------------------------------------------------------

### Database and Query languages

```{r}
Database_and_Query_languages <- paste(DStidy_2022$SQL,DStidy_2022$NoSQL,DStidy_2022$MySQL,DStidy_2022$Hadoop,sep = "::")


d2 <- Database_and_Query_languages %>% table() %>% as.data.frame()
names(d2) <- c('Database_and_Query_languages', 'Frequency')
d2 <- d2[order(d2$Frequency, decreasing = T),]


Database_and_Query_languages[Database_and_Query_languages=="1::0::0::0"] <-"SQL only"
Database_and_Query_languages[Database_and_Query_languages=="1::0::1::0"] <-"SQL & MySQL"
Database_and_Query_languages[Database_and_Query_languages=="1::0::0::1"] <-"SQL & Hadoop"
Database_and_Query_languages[Database_and_Query_languages=="1::1::0::0"] <-"SQL & NoSQL"
Database_and_Query_languages[Database_and_Query_languages=="0::0::0::0"] <-"No database or query languages"

Database_and_Query_languages[Database_and_Query_languages=="0::0::1::0"|
                             Database_and_Query_languages=="0::1::0::0"| 
                             Database_and_Query_languages=="0::0::0::1"| 
                             Database_and_Query_languages=="1::1::1::1"| 
                             Database_and_Query_languages=="1::1::0::1"| 
                             Database_and_Query_languages=="1::0::1::1"| 
                             Database_and_Query_languages=="0::1::1::1"| 
                             Database_and_Query_languages=="0::0::NA::0"| 
                             Database_and_Query_languages=="1::1::1::0"] <- "Other"


d2 <- Database_and_Query_languages %>% table() %>% as.data.frame()
names(d2) <- c('Database_and_Query_languages', 'Frequency')
d2 <- d2[order(d2$Frequency, decreasing = T),]


d2 %>% plot_ly(x = ~Frequency, y = ~reorder(Database_and_Query_languages, Frequency), 
               type =  'bar', orientation = 'h', color = "red") %>% 
  layout(title = "", 
         xaxis = list(title = "Number of job advertisment" ,zeroline = FALSE), 
         yaxis = list(title = ""))


```



Knowledge and Skills
======================================================

```{r, message=FALSE, include=FALSE}

## changing column names 
colnames(DStidy_2022)[colnames(DStidy_2022) == "Natural_Language_Processing(NLP)"] = "Natural Language Processing"
colnames(DStidy_2022)[colnames(DStidy_2022) == "Data_Pipelines"] = "Data Pipelines"
colnames(DStidy_2022)[colnames(DStidy_2022) == "Machine_Learning"] = "Machine Learning"
colnames(DStidy_2022)[colnames(DStidy_2022) == "Computer_vision"] = "Computer Vision"
colnames(DStidy_2022)[colnames(DStidy_2022) == "Data_visualization"] = "Data Visualization"
colnames(DStidy_2022)[colnames(DStidy_2022) == "Data_warehouse"] = "Data Warehouse"
colnames(DStidy_2022)[colnames(DStidy_2022) == "BigData"] = "Big Data"
colnames(DStidy_2022)[colnames(DStidy_2022) == "Data_management"] = "Data Management"
colnames(DStidy_2022)[colnames(DStidy_2022) == "Data_mining"] = "Data Mining"
colnames(DStidy_2022)[colnames(DStidy_2022) == "Data_science"] = "Data Science"
colnames(DStidy_2022)[colnames(DStidy_2022) == "Numerical_Analysis"] = "Numerical Analysis"
colnames(DStidy_2022)[colnames(DStidy_2022) == "Problem_Solving"] = "Problem Solving"
colnames(DStidy_2022)[colnames(DStidy_2022) == "Team_Handling"] = "Team Handling"
colnames(DStidy_2022)[colnames(DStidy_2022) == "agile execution"] = "Agile Execution"
colnames(DStidy_2022)[colnames(DStidy_2022) == "Data_marketing"] = "Data Marketing"
colnames(DStidy_2022)[colnames(DStidy_2022) == "SEO"] = "Search Engine Optimization"
colnames(DStidy_2022)[colnames(DStidy_2022) == "graphics_and_design_skills"] = "Graphic Designing"
colnames(DStidy_2022)[colnames(DStidy_2022) == "Content_Management"] = "Content Management"
colnames(DStidy_2022)[colnames(DStidy_2022) == "Economic"] = "Economic Knowledge"
colnames(DStidy_2022)[colnames(DStidy_2022) == "Finance_Knowledge"] = "Finance Knowledge"
colnames(DStidy_2022)[colnames(DStidy_2022) == "Investment_Knowledge"] = "Investment Knowledge"
colnames(DStidy_2022)[colnames(DStidy_2022) == "Debtor_reconcilation"] = "Debtor Reconcilation"
colnames(DStidy_2022)[colnames(DStidy_2022) == "Presentation_Skills"] = "Presentation Skills"
colnames(DStidy_2022)[colnames(DStidy_2022) == "Payroll_management"] = "Payroll Management"
colnames(DStidy_2022)[colnames(DStidy_2022) == "AI"] = "Artificial Intelligence"
colnames(DStidy_2022)[colnames(DStidy_2022) == "IOT"] = "IOT (Internet of Things)"
```

Column {data-width=650}
-----------------------------------------------------------------------

### Treemap of Knowledge and skills

```{r, message=FALSE, warning=FALSE}
## tree map 

ks<-DStidy_2022 %>% select(c(`Artificial Intelligence`:`IOT (Internet of Things)`,`Presentation Skills`:`Payroll Management`))

df<-ks%>%pivot_longer(1:30)
colnames(df)[1] <- "Knowledge and Skills"
colnames(df)[2] <- "Cases"
df<- df %>%group_by(`Knowledge and Skills`) %>%
  summarize(No_of_Job_vacancies = sum(Cases))%>%mutate(parents="Knowledge and Skills") 

##plot
tree_all <- df%>%plot_ly(type="treemap",labels=~`Knowledge and Skills`,parents=~parents,values=~No_of_Job_vacancies,domain=list(column=0),
             textinfo="label+value+percent parent")
tree_all
```

## Column {.tabset}

### Knowledge

```{r,message=FALSE,warning = FALSE}
## preparing data
Job_Titles <- str_to_lower(DStidy_2022$Job_title)
Job_Titles <- str_trim(Job_Titles)

DS <- Job_Titles[str_detect(Job_Titles, "([data]{4}|machine)[&a-z\\s]*([scientist]{7,10})|\\s+ai")] %>% unique() 
DE <- Job_Titles[str_detect(Job_Titles, "([data]{4}|machine|intelligence)[&a-z\\s]*([engineer]{8,9})")] %>% unique()
DA <- Job_Titles[str_detect(Job_Titles, "anal|statist|actuarial|research|statician")] %>% unique()

DA <- DA %>% append(Job_Titles[!(Job_Titles%in%c(DS,DE,DA))] %>% unique() %>% .[str_detect(.,"data\\s+")]) 
DS <- DS %>% append(Job_Titles[!(Job_Titles%in%c(DS,DE,DA))] %>% unique() %>% .[str_detect(.,"machine\\s+")])

DA <- DA[!DA%in%DS]
DA <- DA[!DA%in%DE]
DS<-DS[!DS%>%is.na()]
DE<-DE[!DE%>%is.na()]
Unimportant <- Job_Titles[!(Job_Titles%in%c(DS,DE,DA))] %>% unique()

DStidy_2022  <- DStidy_2022 %>% mutate(Job_Titles, Job_Category= 
                                         ifelse(Job_Titles%in%DS & Job_Titles%in%DE, "Data Science and Data Engineering", 
                                                ifelse(Job_Titles%in%DS, "Data Science", ifelse(Job_Titles%in%DA,"Data Analyst", "Other" ) ) )) 

## dot chart 
df1<-DStidy_2022%>%select(c(`Artificial Intelligence`:`IOT (Internet of Things)`,Job_Category))
                          
df11 <- df1 %>% pivot_longer(1:16) 

colnames(df11)[2] <- "Knowledge"
colnames(df11)[3] <- "Cases"

df12 <- df11 %>% filter(Cases == 1) 
df12 <- df12 %>% group_by(Knowledge,Job_Category) %>% count()

p2<- ggdotchart(df12,x = "Knowledge" ,y="n",color = "Job_Category",palette = c("#00AFBB","#E7B800","#FC4E07","#FF1493","#7FFFD4"),sorting = "asc",sort.by.groups=TRUE,add="segments",add.params = list(color="lightgray",size=2),dot.size = 4,ggtheme =theme_pubclean())+ font("x.text",size=8,vjust=0.5)+labs(x="Required Knowledge ",y="Count")

ggpar(p2,legend.title = "")%>%ggplotly()%>%layout(legend=list(orientation="h",xanchor="center",x=0.5,y=1.6))
```

### Other required skills 
```{r,message=FALSE,warning = FALSE}
## preparing data 

df2<-DStidy_2022%>%select(c(`Presentation Skills`:`Payroll Management`,Job_Category))
df21 <- df2 %>% pivot_longer(1:14) 
## changing column name 
colnames(df21)[2] <- "Skills"
colnames(df21)[3] <- "Cases"

df22 <- df21 %>% filter(Cases == 1) 
df22 <- df22 %>% group_by(Skills,Job_Category) %>% count()

## dot chart 
p3<- ggdotchart(df22,x = "Skills" ,y="n",color = "Job_Category",palette = c("#00AFBB","#E7B800","#FC4E07","#FF1493","#7FFFD4"),sorting = "asc",sort.by.groups=TRUE,add="segments",add.params = list(color="lightgray",size=2),dot.size = 4,ggtheme =theme_pubclean())+ font("x.text",size=8,vjust=0.5)+labs(x="Required Skills ",y="Count")

ggpar(p3,legend.title = "")%>%ggplotly()%>%layout(legend=list(orientation="h",xanchor="center",x=0.5,y=1.6))
```

Education
======================================================

```{r , include=FALSE}
library(flexdashboard)
library(plotly)
library(dplyr)
```

```{r data}
edu <- DStidy_2022 %>% select("BSc_needed","MSc_needed","PhD_needed")
# convert data set into numeric
edu1 <- as.data.frame(apply(edu, 2, as.numeric))
education <- replace(edu1, is.na(edu1), 1)
d <- education %>%
  rowwise() %>%
  mutate(degree = sum(BSc_needed,MSc_needed,PhD_needed, na.rm = T))

# Education qualification is classified based on the minimum level of education.
for(i in 1:nrow(d)){
 if((d[i,1] == 1 & d[i,4]>=1) == TRUE){  # BSc
    d$V3[i] <- "Bachelor's"
  }else if((d[i,1]== 0 & d[i,2] == 1 & d[i,4]>=1) == TRUE){  # MSc
    d$V3[i] <- "Master's"
  }else if ((d[i,3] == 1 & d[i,4]==1) == TRUE){ # PhD
    d$V3[i] <- "PhD"   
  }else if (( d[i,4]==0 ) == TRUE){  
    d$V3[i] <- "Other"
 
  }}  # other - There is no mention of a degree level, so there could be a different educational qualification. qualification 

d <- d %>% rename(degree_level = V3)
d <- d %>% select(-`degree`)
Final_edu <- d %>% group_by(degree_level) %>% 
  summarise(total_count=n(),
            .groups = 'drop')
Final_edu$degree_level <- factor(Final_edu$degree_level, levels = c("Other","PhD","Master's","Bachelor's"))
``` 


Column {data-width=200, .tabset}
-----------------------------------------------------------------------

### Educational Qualifications

```{r}
plot1 <- Final_edu %>% plot_ly(x = ~total_count, y = ~degree_level, type = 'bar',color = Final_edu$degree_level, domain = list(x = c(0, 0.5), y = c(0, 1))) %>% 
  layout(yaxis = list(title = " Minimum Education Qualification"),title= "Education Qualification",
    xaxis = list(title = "Number of Job Vacancies",tickangle=-45))
                               
  # layout(
  #   title= "Education Qualification",
  #   xaxis = list(title = "Number of Job Vacancies",tickangle=-45 ,c("Other","Diploma","Bachelor's","Master's","PhD")) ,
  #   yaxis = list(title = " Minimum Education Qualification"),font = list(color = 'black'))
plot1
```




Salary 
=====================================

Row
-------------------------------------

### Distibution of Average of Minimum Salaries by Job 


Row
------------------------------------
### Distibution of Average of Minimum Salaries by Countries


Inspiration
======================================================

Our Team
======================================================


